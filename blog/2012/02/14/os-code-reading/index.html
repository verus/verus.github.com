
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Commentary on the Sixth Edition UNIX Operating SystemをKindleで読もうず - Verus Repository</title>
  <meta name="author" content="Verus">

  
  <meta name="description" content="先日，見かけたエントリー( 初めてのOS source code reading(UNIX 6th source code readingのススメ) )で， UNIX 6thは初めてOSのソースコードを読む人にうってつけ！　今すぐ読み始めましょう！ と書いてあったので， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://verus.github.com/blog/2012/02/14/os-code-reading">
  <link href="/favicon.png" rel="icon">
	<link rel="stylesheet" href="/stylesheets/bootstrap.min.css" />
	<link rel="stylesheet" href="/stylesheets/default.css" />
	<style type="text/css">
		/* Override some defaults */
		html, body {
			background-color: #eee;
		}
		body {
			padding-top: 40px; /* 40px to make the container go all the way to the bottom of the topbar */
		}
		.container > footer p {
			text-align: center; /* center align it with the container */
		}
		.container {
			width: 820px; /* downsize our container to make the content feel a bit tighter and more cohesive. NOTE: this removes two full columns from the grid, meaning you only go to 14 columns and not 16. */
		}

		/* The white background content wrapper */
		.container > .content {
			background-color: #fff;
			padding: 20px;
			margin: 0 -20px; /* negative indent the amount of the padding to maintain the grid system */
			-webkit-border-radius: 0 0 6px 6px;
				 -moz-border-radius: 0 0 6px 6px;
							border-radius: 0 0 6px 6px;
			-webkit-box-shadow: 0 1px 2px rgba(0,0,0,.15);
				 -moz-box-shadow: 0 1px 2px rgba(0,0,0,.15);
							box-shadow: 0 1px 2px rgba(0,0,0,.15);
		}

		/* Page header tweaks */
		.page-header {
			background-color: #f5f5f5;
			padding: 20px 20px 10px;
			margin: -20px -20px 20px;
		}

		/* Styles you shouldn't keep as they are for displaying this base example only */
		.content .span10,
		.content .span4 {
			min-height: 500px;
		}
		/* Give a quick and non-cross-browser friendly divider */
		.content .span4 {
			margin-left: 0;
			padding-left: 19px;
			border-left: 1px solid #eee;
		}

		.topbar .btn {
			border: 0;
		}
	</style>

  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/modernizr-transitions.js"></script>
  <script src="/javascripts/ender.js"></script>
  <!-- <script src="/javascripts/octopress.js" type="text/javascript"></script> -->
  <script src="/javascripts/jquery-1.7.1.min.js"></script>
  <script src="/javascripts/jquery.masonry.min.js"></script>
  <script src="/javascripts/jquery.slickwrap.js"></script>
	
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-28036322-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  <link href="/atom.xml" rel="alternate" title="Verus Repository" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-28036322-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
	<header><div class="topbar">
	<div class="fill">
		<div class="container">
			<a class="brand" href="/">Verus Repository</a>
      <ul class="nav">
        <li><a href="/">Home</a></li>
        <li><a href="https://github.com/verus/">GitHub</a></li>
				<li><a href="/blog/">Blog</a></li>
				<li><a href="/contact.html">Contact</a></li>
			</ul>
			<form class="pull-right" action="http://google.com/search" method="get">
					<input type="hidden" name="q" value="site:verus.github.com" />
					<input class="search input-large" type="text" name="q" results="0" placeholder="Search"/>
			</form>

		</div>
	</div>
</div>



</header>
	<div id="main" class="container">
		<div class="content">
			<div class="row">
	<div class="span10" id="content">
		<div>
<article class="hentry" role="article">
  
  <header>
		
      <h2 class="entry-title">Commentary on the Sixth Edition UNIX Operating SystemをKindleで読もうず</h2>
    
    
      <p class="meta">
        








  


<time datetime="2012-02-14T00:00:00+09:00" pubdate data-updated="true">Feb 14<span>th</span>, 2012</time>
        
      </p>
    
  </header>


<div class="entry-content"><p><img src="http://farm8.staticflickr.com/7195/6869623587_ca9ab3a903.jpg" alt="Kidleでよむお！" /></p>

<p>先日，見かけたエントリー( <a href="http://d.hatena.ne.jp/takahirox/20120212/1329049014">初めてのOS source code reading(UNIX 6th source code readingのススメ)</a> )で，</p>

<blockquote><p>UNIX 6thは初めてOSのソースコードを読む人にうってつけ！　今すぐ読み始めましょう！</p></blockquote>

<p>と書いてあったので，なんか開発者なら読んでおかないといけないような強迫観念にさらされたので，ちょっと読んでみようかと思いつつです．</p>

<p>さて，いざ読もうかと思いつつ，さすがに予備知識無しに特攻するのもあれなので，参考文献に挙げられている，<a href="http://www.lemis.com/grog/Documentation/Lions/">Commentary on the Sixth Edition UNIX Operating System</a>を，まずは読むことにします．</p>

<p>ただ，iPadにPDFを入れても，なんか文字小さいし，これは最近はやりの電子書籍端末で読まないといけない気がしたので，Kindleに入れて見ることを試みてみましたと．</p>

<p>ちなみに，<a href="http://www.lemis.com/grog/Documentation/Lions/">Commentary on the Sixth Edition UNIX Operating System</a>は，PostScript, PDF, TeXフォーマットでしか提供されていなかったので，TeXをどうにかEPUB，そしてmobiフォーマットに変換する必要がありますです．</p>

<p>それなら！と探してみたところ，<a href="http://johnmacfarlane.net/pandoc/">Pandoc</a>というツールが発見されました．
これは，</p>

<blockquote><p>Pandoc can read markdown and (subsets of) reStructuredText, textile, HTML, and LaTeX, and it can write plain text, markdown, reStructuredText, HTML, LaTeX, ConTeXt, PDF, RTF, DocBook XML, OpenDocument XML, ODT, GNU Texinfo, MediaWiki markup, textile, groff man pages, Emacs org-mode, AsciiDoc, Microsoft Word docx, EPUB ebooks, and S5 and Slidy HTML slide shows. PDF output (via LaTeX) is also supported.</p></blockquote>

<p>と書いてあるとおり，マークアップ系だいたいを相互に変換できるっぽいみたいなので，TeXをEPUBに変換してみますた．</p>

<p>とりあえず，Pandocを<a href="http://johnmacfarlane.net/pandoc/installing.html">Installing</a>を参照しながら，インストールしてですね．</p>

<p>インストールが終わったら，<a href="http://www.lemis.com/grog/Documentation/Lions/">Commentary on the Sixth Edition UNIX Operating System</a>のページから，<a href="http://www.lemis.com/grog/Documentation/Lions/original.tar.gz">gzipped tarball</a>をダウンロードしてきてですね，それを解凍して，ディレクトリ内で次のコマンドを打ちます．</p>

<blockquote><p>ダウンロード先に移動してー</p>

<p>$ cd ~/Downloads/</p>

<p>作業ディレクトリを作ってー</p>

<p>$ mkdir lionc</p>

<p>解凍して</p>

<p>$ tar zxvf original.tar.gz -C lionc</p>

<p>移動して</p>

<p>$ cd lionc</p>

<p>変換します</p>

<p>$ pandoc -r latex -w epub -o lionc.epub lionc.tex</p></blockquote>

<p>ところがですね，ch12.texが文字コードの問題で落ちます．</p>

<blockquote><p>pandoc: ch12.tex: hGetContents: invalid argument (invalid UTF-8 byte sequence)</p></blockquote>

<p>僕は，ch12.texをvimで開いて，set fileencoding=utf-8とかして回避しました．</p>

<p>いざ，気を撮り直して，コマンド打ちます．</p>

<blockquote><p>$ pandoc -r latex -w epub -o lionc.epub lionc.tex</p></blockquote>

<p>どうでしょう，lionc.epubが出来れば完成ですよ.</p>

<p>あとは，Kindleに入れるとしたら，<a href="http://www.amazon.com/gp/feature.html?ie=UTF8&amp;docId=1000234621">kindlegen</a>で変換するだけです．</p>

<p>と安易に思って変換しようと</p>

<blockquote><p>kindlegen lionc.epub</p></blockquote>

<p>と打ってみたら，</p>

<blockquote><p>Error(prcgen): The book title was not set. Please set the title before generating the mobi.</p></blockquote>

<p>と怒られたので，EPUB内部の書籍情報を追記しないといけないっぽいです．
たぶん，pandocで変換するときに，TeX内にあるtitle的なところを変更しておけば，よかったような気もしますが，ここはどうにか押し通します．</p>

<blockquote><p>一時展開ディレクトリを作ってー</p>

<p>$ mkdir tmp</p>

<p>展開してー</p>

<p>$ unzip lionc.epub -d ./tmp</p>

<p>移動してー</p>

<p>$ cd tmp</p>

<p>書籍情報を編集してー</p>

<p>$ vim content.opf</p></blockquote>

<p>んで，</p>

<blockquote><p>&lt;dc:title>&lt;/dc:title></p></blockquote>

<p>とかなってる空白な要素を</p>

<blockquote><p>&lt;dc:title>Commentary on the Sixth Edition UNIX Operating System&lt;/dc:title></p></blockquote>

<p>のような感じに書き換えます．
そいで，もう一度EPUBにアーカイブします．</p>

<blockquote><p>$ zip lionc.epub *</p></blockquote>

<p>最後にkindlegenでmobiに変換します．</p>

<blockquote><p>$ kindlegen lionc.epub</p></blockquote>

<p>これでlionc.mobiというファイルが出来ましたので，Kindleに転送すればいい感じで読めます．</p>

<p>お疲れ様でした．</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Verus</span></span>

      








  


<time datetime="2012-02-14T00:00:00+09:00" pubdate data-updated="true">Feb 14<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href=' /blog/categories/development/ '>Development</a>, <a class='category' href=' /blog/categories/epub/ '>EPUB</a>, <a class='category' href=' /blog/categories/kindle/ '>Kindle</a>, <a class='category' href=' /blog/categories/os/ '>OS</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://verus.github.com/blog/2012/02/14/os-code-reading/" data-via="verus" data-counturl="http://verus.github.com/blog/2012/02/14/os-code-reading/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href=" /blog/2012/01/01/second-post/ " title="Previous Post: にかいめのぽすと">&laquo; にかいめのぽすと</a>
      
      
        <a class="basic-alignment right" href=" /blog/2012/02/14/easybook/ " title="next Post: ゲーム理論しようぜ in バレンタインデー">ゲーム理論しようぜ in バレンタインデー &raquo;</a>
      
		</p>
  </footer>
</article>

</div>
<!--

<aside class="sidebar">
  
    <section>
  <h5>Recent Posts</h5>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="//blog/2012/02/14/game-theory/">ゲーム理論しようぜ in バレンタインデー</a>
      </li>
		
      <li class="post">
        <a href="//blog/2012/02/14/easybook/">ゲーム理論しようぜ in バレンタインデー</a>
      </li>
		
      <li class="post">
        <a href="//blog/2012/02/14/os-code-reading/">Commentary on the Sixth Edition UNIX Operating SystemをKindleで読もうず</a>
      </li>
		
      <li class="post">
        <a href="//blog/2012/01/01/second-post/">にかいめのぽすと</a>
      </li>
		
      <li class="post">
        <a href="//blog/2012/01/01/first-post/">はじめてのぽすと</a>
      </li>
		
	</ul>
	<ul>
		<li><a href="//blog/archives">Archives</a></li>
    <li><a href="http://d.hatena.ne.jp/verus/" target="_blank">Old Blog(Hatena Diary)</a></li>
		<li><a href="//atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS <img src="//images/rss.png" width="10" height="10"></a></li>
  </ul>
</section>

<section>
  <h5>Github Repos</h5>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/verus">@verus</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'verus',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="//javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h5>Latest Tweets</h5>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("verus", 4, false);
    });
  </script>
  <script src="//javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/verus" class="twitter-follow-button" data-show-count="false">Follow @verus</a>
  
</section>


<section>
  <h5>On Delicious</h5>
  <div id="delicious"></div>
  <script type="text/javascript" src="http://feeds.delicious.com/v2/json/verus?count=3&amp;sort=date&amp;callback=renderDeliciousLinks"></script>
  <p><a href="http://delicious.com/verus">My Delicious Bookmarks &raquo;</a></p>
</section>



<section class="googleplus">
  <h5>
    <a href="https://plus.google.com/114773647433994398834?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="12" height="12">
      Google+
    </a>
  </h5>
</section>



  
</aside>

-->

	</div>
	<div class="span4"><aside class="well">
  
    <div class="profile">
	<h5>Profile</h5>
	<div class="icon"><img src="http://www.gravatar.com/avatar/05436c466c7280e7fb376a47e2adfed5"></div>
	<div class="name">Verus</div>
	<div>
		<a href="http://twitter.com/verus">
				<img src="https://si0.twimg.com/images/dev/cms/intents/bird/bird_blue/bird_16_blue.png">
				Twitter
		</a>
	</div>
	<div>
		<a href="https://plus.google.com/114773647433994398834?rel=author">
			<img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="12" height="12">
			Google+
		</a>
	<div>
		<a href="http://delicious.com/verus">
			<img src="http://www.delicious.com/static/img/delicious.small.gif">
			Delicious
		</a>
	</div>
  </h5>

	</ul>
</div>
<section>
  <h5>Recent Posts</h5>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/02/14/game-theory/">ゲーム理論しようぜ in バレンタインデー</a>
      </li>
		
      <li class="post">
        <a href="/blog/2012/02/14/easybook/">ゲーム理論しようぜ in バレンタインデー</a>
      </li>
		
      <li class="post">
        <a href="/blog/2012/02/14/os-code-reading/">Commentary on the Sixth Edition UNIX Operating SystemをKindleで読もうず</a>
      </li>
		
      <li class="post">
        <a href="/blog/2012/01/01/second-post/">にかいめのぽすと</a>
      </li>
		
      <li class="post">
        <a href="/blog/2012/01/01/first-post/">はじめてのぽすと</a>
      </li>
		
	</ul>
	<ul>
		<li><a href="/blog/archives">Archives</a></li>
    <li><a href="http://d.hatena.ne.jp/verus/" target="_blank">Old Blog(Hatena Diary)</a></li>
		<li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS <img src="/images/rss.png" width="10" height="10"></a></li>
  </ul>
</section>

<section>
  <h5>Github Repos</h5>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/verus">@verus</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'verus',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


  
</aside>


</div>
</div>


		</div>
  </div>
  <footer class="footer" role="contentinfo"><div class="container">
  <p>
		Copyright &copy; 2012 - Verus -
    <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> and <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a> and <a href="http://github.com">Github</a></span>
  </p>
</div>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
